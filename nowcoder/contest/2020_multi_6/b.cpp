#include <cstdio>
#include <cstring>
#include <set>
#include <map>
#include <vector>
#include <algorithm>
 
using namespace std;
const int maxn = 2e7+9;
const int mod = 1e9 + 7;
long long n;
long long s[maxn];
long long ans[maxn];
long long rd[2000];
long long ready[20002] = {0,386742251,1500715,690475804,301559194,453768329,782795404,66892411,388415579,196081639,888496429,413799514,986357443,81676346,604688134,1043545810,809370911,965373518,891182029,671456325,270770002,153799169,777966687,451028156,287897829,529172145,835798317,730376616,148698889,788845112,118185492,393037941,118775907,404217291,463417345,58661314,133783024,161228635,240628287,287773561,372282328,672968528,661510737,1071188145,595426036,676846080,896743204,956700499,1025902116,698802838,366611871,643068815,833506751,73297467,940178695,501349128,289871300,738668773,406781838,617850173,910375620,214815484,616655859,694207794,756594552,588677277,482481772,509914998,832450697,114116155,457403229,990447343,449161417,570220706,379380001,587402443,579107820,277784405,869464084,941771527,526322948,904081270,838418159,780339055,331223658,525950715,763157929,218176501,242188151,238718591,486987718,637818577,224621113,601041662,243768080,628399888,941905307,194519614,222540590,311373368,987622199,282445910,653921170,757442798,964772413,188329651,347506420,778495781,964392614,1035549960,786071963,790479710,1019266360,726104035,284164397,518093106,885928284,974637223,967692577,31609290,416514066,440703867,494298384,1020127341,668797967,148852374,1035180737,64800363,67573704,710059522,210661980,427960599,900552378,175647712,250145159,300421199,535630881,1040345815,800350475,566349999,505218662,864186434,99146481,989080002,630462674,800404351,190585695,346321911,520169477,482020840,335913432,707805208,367259822,875665588,965552949,783320851,728765759,821278629,359586472,230971595,1052727503,736213509,252620250,1036264021,909222354,696220897,1033156029,333399358,806543446,459638201,535841519,425966135,695270523,422814350,1060640843,527450686,868348392,858173029,833353607,155606200,273579457,304602006,592211052,622803512,559155637,916181340,215478169,930403815,877362061,53911172,834211887,469073142,487309973,186702981,291878355,137194351,987954689,854614239,41878507,47443008,336738372,312206412,167494645,41147403,672333443,68618685,281598461,693688249,611405369,304907392,903179046,737220285,658910636,488302881,996305599,551781459,456792513,438625377,78879639,452591675,16250238,1042624991,666471401,1035770497,669312408,972041998,352720290,929896177,17377224,974286888,165594590,850539876,1055150376,1016939158,942579394,520920964,755217636,273956876,158189517,769830424,517508427,347811615,625335057,702374946,702321128,525988099,889599598,587523733,670792163,770162877,749877313,39756391,981678131,220799310,613840533,293188925,552318168,134023646,890554699,263543103,126366815,665520419,483772783,1051626009,605121815,32209792,112650549,800667712,182442250,729289531,439468941,718487933,42859275,1032141585,521077932,240685629,614743051,427114026,837042003,156884076,3954031,612385362,315759060,526996355,566819053,504118330,819170926,241559902,939949397,185351062,706293639,144660649,387338243,927295908,1050431289,113776359,978896091,989560844,753371483,1054229582,62979811,863518237,373793245,253060344,666999611,629534786,849279341,380750904,548621533,902941157,298140557,1051760250,271119808,240356409,1013428765,720272699,546203004,474170682,696355786,113014181,323048079,442418532,810303854,110391120,888583940,574141560,504100156,110912375,400257801,406087830,67716070,651683159,481595516,951439691,459941874,745823204,51976650,355175310,495523343,546261638,1048130191,1029499515,581568770,581161683,589061737,73895106,481692170,587013764,526446613,331669540,99067531,651194549,787066900,916564009,531283657,760684506,459050337,346716522,758623965,86414408,50598018,44800246,863321032,1060422567,871350220,791846920,140498502,809385878,317290856,562133919,144840362,937385236,968730440,546470109,1029749471,267739288,961339961,1598438,759809370,737834049,372366987,529749800,630585412,207681047,717430801,1046770224,41668272,406541554,830208587,121513591,915886331,829971520,865944933,408621539,424396145,881515293,842284544,488846277,226768170,796218853,728652243,472861287,659508287,205806490,121983334,881513369,695453089,842430204,765846061,511971435,259174335,557065406,489035510,84272568,822268361,70178251,626647777,25415057,167103840,454439123,429486537,430280647,121696006,997100979,568053270,645042348,822623816,983681828,435335551,839217159,850619665,121125225,1012885792,761544124,93320849,773054845,466423718,144868810,422312831,251664007,170380290,401092621,786320128,777626284,259706513,779588524,250723615,845255777,1025464466,21600242,838473837,260416178,934195041,837141944,860220477,1070749522,325281893,358780686,13622142,161603989,1071461818,789383904,48588719,529566687,764422426,66132695,637832943,714038940,428450520,628606332,323297330,703449674,108576237,405220499,324574617,72401748,992782545,597572419,377795922,229203756,526696772,906845403,915436527,1057512391,478218565,739697559,59310680,879866218,152685400,713677969,564370594,922766525,334569575,408928983,123828962,812988339,413551375,849510656,416773698,852826435,584468005,399850292,871308280,1045333939,800345125,554697440,109322883,599666825,446501946,26986937,871138912,361263353,618074682,451746850,894831788,367914419,1013301532,517622454,133622876,418872813,857734952,418677152,108704231,284701548,502728372,836721709,1047050342,757174598,440977443,648974590,542572299,320860860,819028927,23243738,622611595,120787222,928300810,223614805,987041933,353485292,48192568,671053025,33442163,340876666,634531496,829782333,1036637934,32611661,854079493,563805401,780101527,1022933841,915971332,186779458,847900340,847347640,694498181,883791783,279641481,213112829,422866986,66056576,957653104,257183732,269290865,265032835,1059268487,907316444,597511341,990650056,86206436,938962558,246141155,129095072,151589505,597048856,706326332,252367865,920509676,58963242,793011033,769302019,477350946,299936634,369832809,823641684,962441475,1044473115,350282421,234781245,525241223,879042106,980943196,186402621,995938734,9591080,961737688,634612631,386546622,941971638,20308374,991346051,820829635,995867966,505289211,471246926,1055152747,196040474,525038047,186084273,967640545,668886435,780816856,682434996,1054726544,874145101,360942109,671244904,654960039,698094146,536502099,40745640,819825299,362142385,938862344,623319234,444621457,84908877,207592164,670759709,660973557,974859141,645603207,526336423,661658061,267561687,641570526,95061222,763710883,605140489,117091338,19370052,252472191,1504661,943243906,1050204937,687811208,945793471,433687790,1018167548,529761294,158477986,639754293,719299445,95118459,125584261,181560471,350714721,162540050,628485060,871762061,281106341,920617777,789176546,170812251,933355123,122155377,845206744,637091507,626315104,512284188,380899552,929103233,485006442,84086079,563605954,703373929,68479106,1020255950,661799257,694956685,306212427,1000725334,621576199,484072162,30667715,450912516,983209376,275781901,61639624,523807455,435531337,695617822,225735085,251188343,903338215,1017640446,872261120,443532953,493873942,227019735,980150379,587909243,896580655,542738427,702304842,232475963,368649870,259459490,120622602,196898251,220716520,602040852,766083646,657552178,277589178,968460985,162713851,82001002,925046860,716957094,384574730,150844427,794509010,385950026,867406297,243276809,925686879,890788798,660786218,751126890,675971699,1010996734,243147682,606433167,773774597,472834770,1022847503,168695231,109657167,436556336,324205136,65513131,665892863,1024140449,481476671,787808463,1017497458,157100099,362543206,573448572,898032809,680357403,236302820,116065803,917533644,145934845,868429151,272986752,417393104,38332810,712171247,681256995,986263062,478954803,261664856,104965387,1027110534,2082007,268118240,232201604,292070971,303697500,461410019,318235277,738726277,1007238130,295321934,644365312,463659997,1021110772,516828880,951537437,190742204,680013831,681416865,129248861,529163363,189111933,268075342,1044515784,74222959,220624056,654436977,960285170,775573126,479569346,94554833,187420325,824731875,101427505,937032796,795511306,1045193936,1071702973,724756217,752053479,892219417,1059484303,1044729056,317095703,340783459,646993151,499530802,692578155,52606390,643864897,845026905,959021494,73349516,87721608,799649575,585678882,136842437,191445043,737851655,98867538,595395644,705415568,178572019,877553545,661875878,404057002,169779714,563614998,691805244,76515517,619379774,316783246,642198959,458027716,931617008,984492660,41086697,602104875,951157299,325462579,412380699,989633558,379352892,659212284,913144593,742341701,499158524,25481672,1025382307,746074540,561699007,295803431,39663278,237357865,343618947,695918945,756752359,812406938,1003788906,385727986,489573536,21683726,1070349406,569654465,328281221,578187147,169195662,1056454295,554799574,6954532,623398904,707370226,706137870,52543767,266840800,1007979685,414688021,166593561,417754355,558249183,281070181,876960472,527555647,943985321,570063129,620097286,1025997808,849700275,1008608947,600017778,590789275,97596271,335336791,954021405,1056363891,359848121,931307320,638373824,567364675,500211459,101623151,1005632516,86620649,154834023,26864925,159421404,904854826,987606322,734802593,848735952,292570539,650471327,718736623,542926917,666960531,1045666768,528736847,693323712,44397683,875496430,935322902,304291507,982541996,30771171,10455525,698610911,264209362,839018737,272730654,339081737,782339351,971794627,702820724,968251206,404608197,300906190,202416549,479841207,126836247,573564264,197308483,420856286,295451619,636340876,218017778,610274580,948923167,507661643,391487744,222403822,283896043,307512544,204557694,452780959,340122074,7657317,1035924264,371006019,883025173,920568707,756174388,752312645,237475059,514385253,740349740,644932779,311153171,147172439,526118360,530573508,193582709,914811328,598491580,621975350,649887609,16075613,1047964146,646739037,423398139,380537014,330782602,109622433,535372140,607555674,944413070,606054899,933338822,370906637,173690517,466534127,154555801,20488012,469617380,117342042,29673736,49337500,239704691,806624675,197550267,861774598,455808671,159217090,255967203,543731661,273080503,588548158,930982150,370983440,838178824,628426770,492177892,16084172,284948862,434968129,454343150,280125380,761064956,748479163,824736260,361800413,330194311,174780383,438185125,553112473,497540771,170513024,795287765,959197836,658385379,816834593,163375229,325711615,896980508,651036046,282476386,882655019,400787252,457460296,482003687,569559716,463079260,1073595133,988976726,109900706,847476059,418699815,429351020,327600845,273080637,992741237,529856671,371243736,624698146,417312625,245471937,967209673,286475434,217494628,150517480,1020501408,715421695,860274305,121024868,358874457,357497928,943405872,796991390,88683394,569428339,653801366,73064023,526587303,554686954,138536566,123002448,709717801,600951161,621570151,970305533,99729718,608982025,834025279,765206023,1052894746,769928110,267338366,887403095,947973256,39540969,307745636,473381101,642285244,491608170,489166344,625207877,340999768,574682185,219826159,646775958,720698456,371789493,317218756,840939046,397957929,66183595,828971413,911359883,82701467,961799819,976513553,504604730,25960114,718114364,258308237,640065150,503636598,80505888,1004654360,561847618,81661503,122755215,530187645,861121626,290747459,297172495,984699983,717198701,41916918,608130686,468082329,901037805,459237024,1028092241,480501906,186837694,477838181,100009336,888343089,855646296,548393244,177303212,1008522762,986486188,1042699101,102672794,308592202,850795344,524261344,844668514,136208344,165945413,798534067,510146957,555052384,170114591,524210176,610273649,939144173,760387289,745709434,785991998,1033388946,448241925,842275089,858623496,558530938,1036867136,791845720,1033877562,358858102,536055153,745571505,393388111,141166349,39328763,1014045894,116463655,863531429,599351748,327040729,17090372,485870549,898311573,269011573,809365002,876122743,710188653,241488777,260250120,189474152,861460083,354846499,356401428,850474250,438378365,1032107650,1005296641,120030194,672128909,40681131,284930206,397573456,142037955,10450396,952240012,551464872,986543707,572152416,567967973,226419976,976940191,582116373,529257197,499428901,546201902,9389155,475008314,533086665,283292937,525727081,1034681904,508127893,189753977,944847113,901747798,689239034,462263911,775674421,545776327,8098551,998941770,790150101,269630438,377666106,320565778,630488736,916972625,739668191,507420872,697330544,248009901,1018744768,234174902,920810340,588912890,79855381,472163431,396465515,1004820999,871082160,813437012,41486473,231263659,132349077,43002803,453064576,653509644,43621197,531932591,950739976,206213056,915955141,869940657,31483441,350244260,754232397,102084438,79208638,714937958,150905096,770658467,488634341,915330433,773820193,520232287,22381826,480666105,571270705,114134652,613231473,1051879200,334628519,652314346,666769297,109835021,522790874,772153931,284081327,691210802,306091251,37249274,698641669,979637464,463913969,306177183,223648456,593477778,7707527,693874470,755220008,612755224,755930508,637098065,1013855750,100310441,430131882,155195755,955695656,407229558,166537194,327930549,870891013,631108610,34167331,927528062,613542676,907285696,296607946,824585868,1047620587,1072675593,156028657,1042753981,275110211,330436058,400211588,1046502522,165498450,830540595,23241167,479900714,220549688,951245173,148216546,192339557,730721091,194140325,49804118,887375239,2034445,820416986,637545471,103111397,323479414,982893858,933103718,414171123,485134605,484213585,902415554,388111687,566696856,492635435,898566077,977427824,601909701,576938012,811953390,43778439,896489430,208150242,108969340,757487945,527287843,476952229,520270317,827256879,1012479924,302193322,369842675,1025376039,93271322,67309123,1067887829,420899760,222304048,792958638,141119617,625383128,110275210,173041423,67283310,886052626,685292594,703587141,524895199,939249950,893908255,596003501,186829567,231997944,327696317,516976029,121662390,17836383,599930377,9074988,453877877,980119433,19326532,57317119,820750830,29602204,685347194,803531213,517180322,571508757,867711785,669735513,1007495928,292834382,759770243,761620436,357164257,792224383,646685713,141008657,314702550,10627765,865893183,500189340,978527669,408783346,175892075,1038106078,514493860,40376212,501600243,793467375,476465233,110689451,1056196095,710143657,517256804,176443113,372417513,825495292,793514221,893235982,175865244,531416316,405132401,966078564,426499342,876891616,398102850,983890784,387761229,978611169,146368497,143430431,181059144,56465001,534097114,545058635,599745165,1039967376,558039369,965420856,201523357,89474365,268817509,1019308479,667846420,776679570,589840165,867308279,986685246,852553431,376733069,14520790,689402424,209303899,345693919,1066290118,349415600,855081718,544599864,838335414,457068992,701994039,130592944,972356632,862737649,616612070,15852148,667868520,197448330,1068496413,15359172,936638442,681603007,267066828,303715021,676781406,1063850670,133942206,865760371,10112973,973090634,23660094,539934106,1031250395,840222730,703272510,48789380,35763357,851907459,5469416,21505505,953910343,211248571,640028939,966924901,801111191,486299247,500394757,227620742,231048289,1057302288,842704590,699421526,962145138,221668226,680263015,624760452,968839543,449468617,262295942,902651753,192096082,741574733,442258078,1042351630,13207269,1032444918,347487964,278580281,79817207,324565097,584542354,215748304,415426611,277789164,685204278,104416784,901218753,217933967,24794323,593975370,486623439,530567113,104801882,509170199,223520899,791950094,623321267,887732069,501063264,161598888,388015767,605116477,407768544,258663936,926243878,733286668,639480659,721305601,1038182675,739367647,1056085870,366593728,272992552,74937167,193792621,427871030,57209152,838881918,809300284,262654292,973554055,341292816,10273943,468117623,785108876,1002284216,441777950,453037648,987279057,481784132,603304163,979712398,614367167,75186740,676498482,314496515,885608597,604736963,17323460,200347471,971021215,528667411,481577368,848481253,574332111,19490167,264386430,961010701,1057540609,944280553,807972624,905303499,1003529444,843141852,957610886,483473882,304805688,945910926,598420376,560831468,217505680,892441814,754824866,322477602,664946816,158101343,133200599,1047950769,685610157,463964668,552189029,725939484,714522648,288134176,149105917,563411649,164110825,817624553,621355057,757711215,50693553,808673790,130879378,226445282,254161337,561475387,905353639,375369095,400271604,103798391,930388645,423407278,555370621,1046853792,540379226,932851035,996291579,385338166,921933910,733731718,47540424,507764816,740234133,145519431,249008490,755543353,841795027,814829592,519566895,287504773,1001477871,302964745,580989929,403976096,1047050117,865770087,113348843,779960242,364508489,195318141,137249550,1037114498,1030351368,802787905,707198160,149855095,995354727,87305253,203515978,403493572,321938724,80329713,71260582,214006646,42891825,567135427,278328042,350156594,144730085,109546784,822791325,1031812687,626695561,336976303,468467794,283053225,1010698092,331264606,766413142,870239600,724004971,985983036,748815678,704954865,48987654,100053478,505457223,988771378,175461514,871901167,952210040,499768430,202710421,890678540,327791378,678650711,620550806,669156519,764618650,214900830,822563983,886170040,520606429,73648410,505341125,901393993,505333146,134681738,858885235,275692364,810252014,1067576951,542754184,177356199,59065379,768773009,597093698,1029798448,284286703,586800082,478177564,284387834,704492679,897668110,700922968,373905674,437767861,210233081,448798401,960923783,945481513,120402317,812624916,1070388881,651676691,342508487,387518597,900052043,802880769,1042688632,601592260,833972819,382528244,494118919,1063820537,599959278,358397158,933514658,561327639,171912480,618367493,682264124,107447124,782355502,881762804,553572216,919670888,39059275,970509964,509360469,429883476,963546394,834886923,601635925,857669553,598367907,708097221,572442918,853457614,1001792114,1067565669,769721183,712053579,1058409627,203967457,802557329,633434281,114496826,348849203,337105889,203021688,439501679,813180791,1057467810,125834850,210633208,428060394,96696955,989145005,525510102,759972928,110735188,978817258,661421617,326488563,558496201,424554439,858180852,401494870,410770742,421500389,255719883,289050960,532749197,655057962,808397635,1067448606,117846394,1270412,520825330,971517171,71413609,585631668,1035035431,265115886,542746939,101913673,516004120,803215390,269382086,452442725,227023539,284286925,525546157,1031428620,453686999,603062960,677570491,882085491,870732722,760443181,175450347,160465324,167488079,1021465824,730439805,811455623,715859174,354923032,1069937050,1040573222,863619790,84991392,463758330,463040403,193685088,33933467,1017215697,709592056,257740715,71261214,396761659,129690563,618614927,1011693798,795347699,525518321,267667471,744538739,312857203,515606729,1001324755,465973160,374974853,60581788,883978197,151406111,691571340,363461517,248971778,794798156,658006531,901886314,242185275,847807768,668328968,651003663,599583556,354467524,867617590,956740874,29888897,134052541,560908447,789627394,522501368,381864343,550266247,839970306,697506970,118764215,764387146,139331215,793599183,637734936,773755120,399456469,125089716,1046520360,159746094,204650696,1050617430,467010677,108650292,42931442,233443800,618966328,169578683,150395472,794605332,567840834,1049253227,833869845,859864491,809357428,97561401,219944513,227143951,973771694,475974809,674056953,498392356,302285837,630138120,171899786,637167959,833581237,607410895,526226294,386372457,762279792,677505682,370778158,168140936,6209253,456133845,554339155,958413012,642717057,983746557,62687465,704866989,688773706,950088397,662693288,160928784,1035526519,591146916,473026878,470147128,722377709,232251305,498892304,64807543,545729172,181268270,513106677,229058775,982788812,527442127,714330454,139514587,349888234,21985509};
long long pow_mod(long long a,long long b){
    long long ans = 1 , tmp = a;
    while(b) {
        if (b&1) ans = ans * tmp % mod;
        b>>=1 , tmp = tmp * tmp % mod;
    }
    return ans;
}
void init()
{
    //freopen("ans.txt","w",stdout);
    s[1] = 1;
    //ans[1] = 500000004;
    long long tmp = 2,x = 2;
    for( long long i = 2; i <= 2e7; i++ ) {
        tmp<<=1;
        if ( tmp - 1 >= mod ) tmp -= mod;
        s[i] = s[i-1] * (tmp-1) % mod;
        /*x = x * tmp % mod;
        ans[i] = s[i] * pow_mod( x , mod-2 )%mod;
        ans[i] ^= ans[i-1];*/
        //if ( i % 1000 == 0 ) printf("%lld,",ans[i]);
    }
 
}
 
void data()
{
    freopen("ans.txt","w",stdout);
    s[1] = 1;
    ans[1] = 500000004;
    long long tmp = 2,x = 2;
    for( long long i = 2; i <= 2e7; i++ ) {
        tmp<<=1;
        if ( tmp - 1 >= mod ) tmp -= mod;
        s[i] = s[i-1] * (tmp-1) % mod;
        x = x * tmp % mod;
        ans[i] = s[i] * pow_mod( x , mod-2 )%mod;
        ans[i] ^= ans[i-1];
        if ( i % 10000 == 0 ) printf("%lld,",ans[i]);
    }
 
}
long long cal( long long n ){
    long long id = n / 10000;
    long long pre = ready[id];
    long long tmp = pow_mod(2,id*10000) , x = pow_mod(2,(id*10000)*(id*10000+1)/2 );
 
    for( long long i = id*10000 + 1; i <= n; i++ ){
        tmp<<=1;
        if ( tmp - 1 >= mod ) tmp -= mod;
        x = x * tmp % mod;
        pre ^= s[i] * pow_mod( x , mod-2 )%mod;
    }
    return pre;
}
 
int main()
{ 
    //data();
    init();
    int T,x;
    n = 0;
    // p.clear();
    // for( int i = 1; i <= 1000000; i++ ){
    //     long long tmp = pow_mod( pow_mod(2,(i+1)*i/2) , mod-2 )%mod;
 
    //     //printf("%d : %lld\n", i,pow_mod( pow_mod(2,(i+1)*i/2) , mod-2 )%mod );
    //     if ( p[tmp] ) printf("    %d : %d\n", i,p[tmp]);
    //     else p[tmp] = i;
    // }
    scanf("%d",&T);
    for(int i = 1; i <= T; i++) {
        scanf("%lld",&n);
        printf("%lld\n",cal(n) );
    }
     
    //init();
    // for(int i = 1; i <= T; i++) {
    //     //scanf("%lld",&n);
    //     printf("%lld\n",ans[ rd[i] ]);
    // }
    return 0;
}